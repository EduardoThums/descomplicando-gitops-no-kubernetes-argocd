apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: dev-eks-lab
  namespace: argo
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-sm
    kind: ClusterSecretStore
  target:
    name: dev-eks-lab
    template:
      metadata:
        labels:
          argocd.argoproj.io/secret-type: cluster
  data:
    - secretKey: config
      remoteRef:
        key: argocd-cluster-secret-dev-lab
        property: config
    - secretKey: name
      remoteRef:
        key: argocd-cluster-secret-dev-lab
        property: name
    - secretKey: server
      remoteRef:
        key: argocd-cluster-secret-dev-lab
        property: server

---

apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: prod-eks-lab
  namespace: argo
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-sm
    kind: ClusterSecretStore
  target:
    name: prod-eks-lab
    template:
      metadata:
        labels:
          argocd.argoproj.io/secret-type: cluster
  data:
    - secretKey: config
      remoteRef:
        key: argocd-cluster-secret-prod-lab
        property: config
    - secretKey: name
      remoteRef:
        key: argocd-cluster-secret-prod-lab
        property: name
    - secretKey: server
      remoteRef:
        key: argocd-cluster-secret-prod-lab
        property: server